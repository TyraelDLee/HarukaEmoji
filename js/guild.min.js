!async function(){async function a(){return"space.bilibili.com"===window.location.hostname?{uid:window.location.pathname.split("/")[1],type:"space"}:await fetch(`https://api.live.bilibili.com/xlive/web-room/v2/index/getRoomPlayInfo?room_id=${window.location.pathname.split("/")[1]}&no_playurl=0&mask=1&qn=0&platform=web&protocol=0,1&format=0,1,2&codec=0,1&dolby=5&panorama=1`,{method:"GET",credentials:"include",body:null}).then(a=>a.json()).then(a=>0===a.code?{uid:a.data.uid,type:"live"}:{uid:0,type:""}).catch(()=>({uid:0,type:""}))}async function b(a){const b=await fetch(chrome.runtime.getURL("../guild/guildList.json")).then(a=>a.json()),c=await fetch(chrome.runtime.getURL("../guild/finalresult.json")).then(a=>a.json());let d=0;for(let b of c.fulldatalist)for(let c of b.vlist)if(a-0===c.uid){d=b.gid;break}for(let c of b.guildinfolist)if(c.gid===d)return c.name}function c(a){try{const b=document.getElementById("app").getElementsByClassName("h")[0].getElementsByClassName("h-user")[0].getElementsByClassName("h-basic")[0].getElementsByTagName("div")[0],c=document.createElement("span");c.setAttribute("title",`数据没有时效性，仅供参考`),c.classList.add("guild-badge"),c.innerText=`所属公会: ${a}`,b.append(c),f++,console.log("retried")}catch(b){50>f&&setTimeout(()=>{c(a)},200)}}function d(a){try{const b=document.getElementsByClassName("upinfo-detail__top")[0],c=document.createElement("span");c.setAttribute("title",`数据没有时效性，仅供参考`),c.classList.add("guild-badge"),c.classList.add("guild-new"),c.innerText=`所属公会: ${a}`,b.append(c),g++}catch(b){50>g&&setTimeout(()=>{d(a)},200)}}let f=0,g=0;if(/^\d*$/.test(window.location.pathname.split("/")[1])){const e=await a(),f=await b(e.uid);if(0!==e.uid&&""!==f)if("space"===e.type)c(f),d(f);else if("live"===e.type){const a=document.getElementsByClassName("upper-row")[0].getElementsByClassName("right-ctnr")[0],b=document.createElement("div");b.setAttribute("class","icon-ctnr live-skin-normal-a-text not-hover"),b.setAttribute("style","line-height: 16px; pointer-events: none;");b.innerHTML+=`<span class="action-text v-middle watched-icon">所属公会: </span><span title="数据没有时效性，仅供参考" class="action-text v-middle watched-text">${f}</span>`,a.prepend(b)}}}();