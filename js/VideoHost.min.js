!function(){function e(){z=window.innerHeight*G,U=window.innerWidth*G}function t(e){return 180-8*e.length}function i(e,t,i,a){var n=Math.abs;return 0===n(e-i)&&0===n(t-a)}function a(t){let i=document.getElementById(t),e=[i.offsetLeft,i.offsetTop],a=i.offsetParent;for(;null!==a;)e[0]+=a.offsetLeft,e[1]+=a.offsetTop+a.clientTop,a=a.offsetParent;return e[0]+=i.clientWidth-60,e[1]+=i.clientHeight-60,e}function n(){let e=a("danmukuBox");Y=[U-e[0],e[1],e[0]],Y[2]>U-60?(J.style.left=U-60+"px",Q.style.left=U-370+"px"):(J.style.left=Y[2]+"px",Q.style.left=Y[2]-310+"px")}function l(){if(null===localStorage.getItem("rua_pos"))n(),K=!1;else if(localStorage.getItem("rua_pos").includes("undefined"))localStorage.removeItem("rua_pos"),n(),K=!1;else{K=!0;for(let e=0;3>e;e++)Y[e]=parseInt(localStorage.getItem("rua_pos").split(",")[e]);let e=0;e=Y[0]<Y[2]?U-Y[0]:Y[2],Y[1]>z-50&&(Y[1]=z-50),J.style.left=e+"px",Q.style.left=320>e?e+60+"px":e-310+"px"}}function d(e){e?Q.style.background="#151515":Q.style.removeProperty("background")}function o(){L=0>L?0:L,I=[],R=[],fetch("https://api.bilibili.com/x/web-interface/view?"+h(A),{method:"GET",credentials:"include",body:null}).then((e)=>e.json()).then((e)=>{if(0===e.code){P=e.data.aid,T=e.data.bvid,R.push(e.data.title);for(let t=0;t<e.data.pages.length;t++)I.push(e.data.pages[t].cid),1<e.data.pages.length&&R.push(e.data.pages[t].part);s(I[L])}})}function s(e){for($.innerHTML="<b style='user-select: none'>\u89C6\u9891ID\uFF1A</b> <span>av"+P+"</span><span style='user-select: none'> / </span><span>"+T+"</span>",ee.innerText=L-1+2+"p/"+I.length+"p",b(),de.innerHTML="",M=0,N=0,F=new DanmakuArr,H=new DanmakuArr,document.getElementById("rua-danmaku-search-input").value="";ae.hasChildNodes();)ae.firstChild.onmousedown=null,ae.removeChild(ae.firstChild);V=!0,fetch("https://api.bilibili.com/x/player/playurl?bvid="+T+"&cid="+e+"&qn=120&type=flv&fourk=1",{method:"GET",credentials:"include",body:null}).then((e)=>e.json()).then((t)=>{if(0===t.code){for(let e=0;e<t.data.durl.length;e++)M+=t.data.durl[e].length-1+1;for(let a=0;a<t.data.accept_quality.length;a++){q[t.data.accept_quality[a]]={accept_description:t.data.accept_description[a],accept_format:t.data.accept_format.split(",")[a]};let i=document.createElement("div");i.setAttribute("id","qn-"+t.data.accept_quality[a]),i.classList.add("rua-download-block"),i.innerHTML="<div class='rua-quality-des'>"+q[t.data.accept_quality[a]].accept_description+"</div>",de.appendChild(i),_.push(i),i.onclick=()=>{g(T,e,t.data.accept_quality[a],R[0]+(1===R.length?"":R[L+1])+" "+t.data.accept_description[a])}}de.style.height=40*x(_.length/3)+"px",r(e,!0,!0),k(e,P,1,D(M))}})}function r(e,t,i){fetch("https://api.bilibili.com/x/player/playurl?bvid="+T+"&cid="+e+"&qn=120&fnval=272",{method:"GET",credentials:"include",body:null}).then((e)=>e.json()).then((a)=>{if(0===a.code&&null!==a.data){if(null!==a.data.dash.dolby&&t){let t=document.createElement("div");t.setAttribute("id","qn-dolbyAtmos"),t.classList.add("rua-download-block"),t.innerHTML="<div class='rua-quality-des'>\u675C\u6BD4\u5168\u666F\u58F0</div>",de.appendChild(t),_.push(t),de.style.height=40*x(_.length/3)+"px",t.onclick=()=>{O&&3.6e6>a.data.timelength?u(a.data.dash.dolby.audio[0].base_url,R[0]+(1===R.length?"":" "+R[L+1]),e,t,!0):p(a.data.dash.dolby.audio[0].base_url)}}if(null!==a.data.dash.audio[0].base_url&&i){let t=document.createElement("div");t.setAttribute("id","qn-sound"),t.classList.add("rua-download-block"),t.innerHTML="<div class='rua-quality-des'>Sound Only</div>",de.appendChild(t),_.push(t),de.style.height=40*x(_.length/3)+"px",t.onclick=()=>{O&&3.6e6>a.data.timelength?u(a.data.dash.audio[0].base_url,R[0]+(1===R.length?"":" "+R[L+1]),e,t,!1):p(a.data.dash.audio[0].base_url)}}}})}function p(e){e+="&requestFrom=ruaDL",chrome.runtime.sendMessage({msg:"requestDownload",fileName:R[0]+(1===R.length?"":" "+R[L+1])});const t=document.createElement("a");t.style.display="none",t.href=e,t.target="_Blank",t.referrerPolicy="unsafe-url",t.download,document.body.appendChild(t),t.click(),document.body.removeChild(t)}function u(e,t,i,a,n){a.onclick=null;let l=0,d=0,o=a.getElementsByClassName("rua-quality-des")[0].innerText;a.removeAttribute("title"),fetch(e,{method:"GET",body:null}).then((e)=>(a.getElementsByClassName("rua-quality-des")[0].innerText="\u4E0B\u8F7D\u4E2D...",l=e.headers.get("Content-Length"),e.body)).then((e)=>{const t=e.getReader();return new Response(new ReadableStream({start(e){function i(){return t.read().then((t)=>{const{done:n,value:o}=t;return n&&(e.close(),a.getElementsByClassName("rua-quality-des")[0].innerText="\u8F6C\u7801\u4E2D..."),d+=o.length||0,y(a,100*(d/l)),e.enqueue(o),i()})}return i()}})).blob()}).then((e)=>{const l=window.URL.createObjectURL(e);chrome.runtime.sendMessage({msg:"requestEncode",blob:l,filename:t,startTime:-1,duration:-1,requestType:n?"dolbyRecord":"audioRecord"},function(e){console.log(e.status),"ok"===e.status&&(a.removeAttribute("style"),a.removeAttribute("title"),a.getElementsByClassName("rua-quality-des")[0].innerText=o,c(i))})}).catch((t)=>{m(a,i,t.toString(),!1)})}function y(e,t){e.setAttribute("style","background: linear-gradient(to right, #23ade5 0%, #23ade5 "+t+"%, #fb7299 "+t+"%, #fb7299);")}function m(e,t,i,a){console.log(i),e.setAttribute("style","background: #ff4650;"),e.setAttribute("title",i),e.getElementsByClassName("rua-quality-des")[0].innerText=a?"\u8F6C\u7801\u5931\u8D25":"\u4E0B\u8F7D\u5931\u8D25",e.onclick=()=>{e.onclick=null,c(t)}}function c(e){let t=0;typeof document.getElementById("qn-dolbyAtmos")!==void 0&&null!==document.getElementById("qn-dolbyAtmos")&&(document.getElementById("qn-dolbyAtmos").removeAttribute("title"),document.getElementById("qn-dolbyAtmos").onclick=null,document.getElementById("qn-dolbyAtmos").parentElement.removeChild(document.getElementById("qn-dolbyAtmos")),t=2),typeof document.getElementById("qn-sound")!==void 0&&null!==document.getElementById("qn-sound")&&(document.getElementById("qn-sound").removeAttribute("title"),document.getElementById("qn-sound").onclick=null,document.getElementById("qn-sound").parentElement.removeChild(document.getElementById("qn-sound")),t=1),_.splice(_.length-t,t),console.log(_),r(e,!0,!0)}function g(e,t,i,a){let n=new XMLHttpRequest;n.withCredentials=!0,n.open("GET","https://api.bilibili.com/x/player/playurl?bvid="+T+"&cid="+t+"&qn="+i+"&type=flv&fourk=1"),n.send(null),n.onload=function(){200===n.status&&0===JSON.parse(n.responseText).code&&null!==JSON.parse(n.responseText).data.durl&&f(JSON.parse(n.responseText).data.durl,a,0,JSON.parse(n.responseText).data.durl.length)}}function f(e,t,i,n){const l=e[i].url+"&requestFrom=ruaDL";chrome.runtime.sendMessage({msg:"requestDownload",fileName:t+(1===e.length?"":"_p"+i)});const d=document.createElement("a");document.body.appendChild(d),d.style.display="none",d.href=l,d.target="_Blank",d.referrerPolicy="unsafe-url",d.download,d.click(),document.body.removeChild(d),++i,i<n&&setTimeout(()=>{f(e,t,i,n)},2e3)}function b(){for(let e=0;e<_.length;e++)_[e].onclick=null;_=[]}function h(e){let t="AaBb";if(t.includes(e.charAt(0))&&"Vv".includes(e.charAt(1)))return t.substr(0,2).includes(e.charAt(0))?"aid="+e.replace("av",""):"bvid="+e}function k(e,i,a,n){fetch("https://api.bilibili.com/x/v2/dm/web/seg.so?type=1&oid="+e+"&pid="+i+"&segment_index="+a,{method:"GET",credentials:"include",body:null}).then((e)=>e.arrayBuffer()).then((l)=>{const d=new Uint8Array(l),o=protobuf.Root.fromJSON(dmObj);var s=o.lookupType("bilibili.community.service.dm.v1.DmSegMobileReply");chrome.runtime.sendMessage({msg:"requestDanmaku",danmakuObj:s.decode(d).elems},function(e){if(F.concat(e.danmakuContent),H.concat(e.danmakuContent),N+=e.danmakuPoolSize,document.getElementById("rua-danmaku-size").innerText="\u5171"+N+" \u5F39\u5E55",document.getElementById("rua-input-container").setAttribute("style",`width: ${t(N+"")}px`),ae.style.height=20*H.size+"px",V){for(let e=0;20>e;e++)!B(ae,"rua-danmaku-content","rua-danmaku-"+e)&&e<H.size&&H.get(e).look&&ae.appendChild(E(H.get(e).time,H.get(e).content,H.get(e).mid,e));V=20>H.size}a===n&&(document.getElementById("rua-danmaku-download").setAttribute("style",""),document.getElementById("rua-danmaku-download").innerText="\u5F39\u5E55\u4E0B\u8F7D",w.setTitle(R[0]+(1===R.length?"":R[L+1])))}),a<n&&(a++,k(e,i,a,n))}).catch(()=>{})}function D(e){return x(e/3.6e5)}function v(e){let t=Math.floor(e/20)-5;for(;ae.hasChildNodes();)ae.firstChild.onmousedown=null,ae.removeChild(ae.firstChild);for(let a=0;25>a;a++)void 0!==H.get(t+a)&&ae.appendChild(E(H.get(a+t).time,H.get(a+t).content,H.get(a+t).mid,a+t))}function E(e,t,i,a){const n=document.createElement("div"),l=document.createElement("span"),d=document.createElement("span"),o=e.split(":"),s=[1,60,3600];let r=0;for(let n=o.length-1;0<=n;n--)r+=(o[o.length-1-n]-1+1)*s[n];return n.setAttribute("title",t),n.setAttribute("id","rua-danmaku-"+a),n.style.top=20*a+"px",n.classList.add("rua-danmaku-content"),l.setAttribute("class","seek-video rua-danmaku-time"),l.setAttribute("data-time",r),l.innerText=e,n.appendChild(l),d.classList.add("rua-danmaku"),d.innerText=t,n.appendChild(d),n.onmousedown=function(t){0===t.button&&C(document.body,i,Q.style.left.replace("px","")-1+1,t.clientY-140,a)},n}function C(t,e,i,a){const n=document.createElement("div");n.setAttribute("class","rua-danmaku-user-info"),n.setAttribute("style","top:"+a+"px;left:"+i+"px;");const l=document.createElement("div");l.setAttribute("class","rua-danmaku-user-host");const d=document.createElement("div");d.setAttribute("id","rua-user-control-bar"),d.innerHTML="<b style=\"padding-left: 20px;\">\u7528\u6237\u4FE1\u606F</b>";const o=document.createElement("div");if(o.setAttribute("style","position: absolute; top: 2px; left: 280px; width: 14px; height: 14px;"),o.innerHTML="<svg width=\"14\" height=\"14\"><circle cx=\"7\" cy=\"7\" r=\"7\" fill=\"#f16c59\"/><line class=\"rua-cross\" x1=\"4\" y1=\"4\" x2=\"10.5\" y2=\"10.5\" style=\"stroke:#f16c59;stroke-width:1\"/><line class=\"rua-cross\" x1=\"10.5\" y1=\"4\" x2=\"4\" y2=\"10.5\" style=\"stroke:#f16c59;stroke-width:1\"/></svg>",d.appendChild(o),0<document.body.getElementsByClassName("rua-danmaku-user-info").length){o.onmouseenter=null,o.onmouseleave=null,o.onmousedown=null,document.getElementById("app").onmousedown=null;for(let e=0;e<document.body.getElementsByClassName("rua-danmaku-user-info").length;e++)document.body.removeChild(document.body.getElementsByClassName("rua-danmaku-user-info")[e])}o.onmouseenter=()=>{for(let e=0;e<o.getElementsByClassName("rua-cross").length;e++)o.getElementsByClassName("rua-cross")[e].style.stroke="#A0000A"},o.onmouseleave=()=>{for(let e=0;e<o.getElementsByClassName("rua-cross").length;e++)o.getElementsByClassName("rua-cross")[e].style.stroke="#f16c59"},o.onmousedown=(i)=>{0===i.button&&(o.onmouseenter=null,o.onmouseleave=null,o.onmousedown=null,document.getElementById("app").onmousedown=null,t.removeChild(n))};const s=document.createElement("div");s.setAttribute("id","rua-user-host"),s.classList.add("emoji_sec");for(let n=0;n<e.length;n++)chrome.runtime.sendMessage({msg:"requestUserInfo",mid:e[n]},(t)=>{const i=document.createElement("div");i.setAttribute("class","rua-user");const a=document.createElement("a"),l=document.createElement("img");a.href="https://space.bilibili.com/"+e[n],a.target="_Blank",a.setAttribute("class","rua-user-avatar"),l.classList.add("bili-avatar-img"),l.setAttribute("src",t.response.face.replace("http://","https://")),a.appendChild(l),i.appendChild(a);const d=document.createElement("div");d.setAttribute("style","padding-left: 50px; padding-top: 9px;min-width: 100px;");const o=document.createElement("a");o.href="https://space.bilibili.com/"+e[n],o.target="_Blank";const r=document.createElement("b");r.innerText=t.response.name;const p=document.createElement("a");p.href="https://space.bilibili.com/"+e[n],p.target="_Blank",p.innerText="uid: "+e[n];const u=document.createElement("br");o.appendChild(r),d.appendChild(o),d.appendChild(u),d.appendChild(p),i.appendChild(d),s.appendChild(i)});l.appendChild(d),l.appendChild(s),n.appendChild(l),t.appendChild(n),document.getElementById("app").onmousedown=()=>{o.onmouseenter=null,o.onmouseleave=null,o.onmousedown=null,document.getElementById("app").onmousedown=null,t.removeChild(n)}}function B(e,t,a){for(let n=0;n<e.getElementsByClassName(t).length;n++)if(e.getElementsByClassName(t)[n].id===a)return!0;return!1}var x=Math.ceil;const S=chrome.runtime.getURL("../images/haruka/abaaba.svg"),w=new AssConvert(1280,720);var A=window.location.pathname.replaceAll("/","").replace("video",""),P="",T="0",L=null===new URLSearchParams(window.location.search).get("p")?0:new URLSearchParams(window.location.search).get("p")-1,I=[],q={},R=[],_=[],M=0,N=0,F=new DanmakuArr,H=new DanmakuArr,V=!0,O=!1;chrome.storage.sync.get(["wav"],function(e){O=e.wav}),chrome.storage.onChanged.addListener(function(e){for(let[t,{oldValue:i,newValue:a}]of Object.entries(e))"wav"===t&&(O=a)});var z,U,j=window.innerWidth,W=[],G=1;new MutationObserver(()=>{const e=new URLSearchParams(window.location.search).get("p")-1,t=window.location.pathname.replaceAll("/","").replace("video","");null!==new URLSearchParams(window.location.search).get("p")&&L!=e&&(L=e,s(I[e])),null!==t&&t!==A&&(A=t,o())}).observe(document,{subtree:!0,childList:!0}),e();var K=!1,Y=[100,100,100];const X=document.body,J=document.createElement("div"),Q=document.createElement("div"),Z=document.createElement("div");Z.setAttribute("id","rua-video-info"),Z.style.paddingTop="2px";const $=document.createElement("div");$.setAttribute("style","float: left; padding-left:5px"),Z.appendChild($);const ee=document.createElement("span");ee.setAttribute("style","float: right; padding-right:5px; user-select: none;"),Z.appendChild(ee);const te=document.createElement("div");te.setAttribute("id","rua-danmaku"),te.classList.add("emoji_sec");const ie=document.createElement("div");ie.setAttribute("style","width: 300px; position: fixed; background: #fff"),ie.innerHTML=`<div style='float: left; padding-left: 5px; user-select: none;'><b>弹幕：</b></div><div style='float: right; padding-right: 5px; user-select: none;' id='rua-danmaku-size'>共${N} 弹幕</div><div style='float: right; padding-right: 5px;user-select: none;cursor: pointer' id='rua-danmaku-search' title='查询弹幕内容'><svg width='18' height='18' viewBox='0 0 18 18' xmlns=\"http://www.w3.org/2000/svg\"><circle cx=\"8\" cy=\"8\" r=\"5\" style=\"stroke:#aaa;stroke-width:2; fill: none\"/><line x1=\"11.5\" y1=\"11.5\" x2=\"15\" y2=\"15\" style=\"stroke:#aaa;stroke-width:2\" /></svg></div><div id='rua-input-container' style='width: ${t(N+"")}px'><textarea id='rua-danmaku-search-input' class='rua-danmaku-search-out' style='display: none' placeholder='输入要查询的弹幕内容'></textarea></div>`;const ae=document.createElement("div");ae.style.position="relative",te.appendChild(ae);const ne=document.createElement("div");ne.setAttribute("id","rua-download"),ne.classList.add("emoji_sec");const le=document.createElement("div");le.setAttribute("style","width: 290px; position: fixed; background: #fff"),le.innerHTML=`<div style='float: left; user-select: none; padding-left: 5px'><b>视频下载：</b></div><div id="rua-danmaku-download" style="opacity: 0.8; cursor: not-allowed;" title="将弹幕保存为ass文件">加载中</div><div style="float: right; margin: -2px 10px 0 0"><label for="rua-danmaku-intense"></label><select id="rua-danmaku-intense"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10" selected>10</option></select></div><div style="float: right; margin-right: 5px;">弹幕强度</div></div>`;const de=document.createElement("div");de.setAttribute("style","margin: 0 0 0 15px;"),ne.appendChild(de),0===document.getElementsByTagName("article").length&&function(){l(),J.setAttribute("id","emoji-popup"),J.style.background="url("+S+") no-repeat center",J.style.backgroundSize="contain",J.style.cursor="pointer",J.innerHTML="<!---->",Q.setAttribute("id","emoji-selection"),Q.classList.add("emoji_sec"),Q.style.display="none",Q.innerHTML="",Q.appendChild(Z),Q.appendChild(ie),Q.appendChild(te),Q.appendChild(le),Q.appendChild(ne),X.appendChild(Q),X.appendChild(J),J.style.top=Y[1]+"px",Q.style.top=Y[1]-5+"px";var t=[0,0],a=[0,0];window.onload=function(){J.onmousedown=function(e){let n,l;document.body.style.userSelect="none",J.className="popup-click-in";const d=e||event,o=d.clientX-J.offsetLeft,s=d.clientY-J.offsetTop;t=[J.offsetLeft,J.offsetTop],a=[J.offsetLeft,J.offsetTop],document.onmousemove=function(e){const t=e||event;0<=t.clientX-o&&t.clientX-o<=U-70&&(n=t.clientX-o),0<=t.clientY-s&&t.clientY-s<=z-60&&(l=t.clientY-s),a=[n,l],J.style.left=n+"px",J.style.top=l+"px",Q.style.left=320>n?n+60+"px":n-310+"px",Q.style.top=l>z-360?z-360+"px":l-5+"px",l===void 0&&(l=J.offsetTop),-1<n&&(Y=[U-n,l,n])},document.onmouseup=function(){document.body.style.userSelect="auto",J.className="popup-click-out",i(t[0],t[1],a[0],a[1])?"none"===Q.style.display?(Q.classList.remove("selection-fade-out"),Q.style.display="block",Q.classList.add("selection-fade-in")):(Q.classList.remove("selection-fade-in"),Q.classList.add("selection-fade-out"),setTimeout(()=>{Q.style.display="none"},300)):(K=!0,localStorage.setItem("rua_pos",Y[0]+","+Y[1]+","+Y[2])),document.onmousemove=null,document.onmouseup=null}},J.onmouseenter=function(){J.className="popup-click-hoverin"},J.onmouseleave=function(){J.className="popup-click-hoverout"}},window.addEventListener("resize",function(){let t,i=Y[0]<Y[2]?Y[0]/j:Y[2]/j;e(),K?(t=Y[0]<Y[2]?U-Y[0]:Y[2],J.style.left=t+"px"):n(),Y[1]>z-60&&(J.style.top=z-60+"px",Q.style.top=z-360+"px"),Q.style.left=320>t?t+60+"px":t-310+"px"}),document.getElementById("rua-danmaku-download").addEventListener("click",()=>{0===document.getElementById("rua-danmaku-download").getAttribute("style").length&&(w.feedDanmaku(F),w.downloadASS())}),document.getElementById("rua-danmaku-intense").addEventListener("change",function(){console.log(this.value);let e=this.value-1+1;w.setWeight(10-e)})}();var oe=new MutationObserver(function(e){e.forEach(function(e){"attributes"===e.type&&(null===se.getAttribute("lab-style")?d(!1):(W=se.getAttribute("lab-style").split(","),-1===W.indexOf("dark")?d(!1):d(!0)))})});const se=document.documentElement;oe.observe(se,{attributes:!0}),o(),te.onscroll=function(t){20<=H.size&&v(t.target.scrollTop)},document.getElementById("rua-danmaku-search-input").addEventListener("focus",()=>{document.getElementById("rua-danmaku-search-input").style.borderColor="#23ade5"}),document.getElementById("rua-danmaku-search-input").addEventListener("blur",()=>{document.getElementById("rua-danmaku-search-input").style.borderColor="#aaa"}),document.getElementById("rua-danmaku-search-input").addEventListener("input",(t)=>{H=F.find(t.target.value),ae.style.height=20*H.size+"px",ae.scrollTop=0,v(0)});let re=!1;document.getElementById("rua-danmaku-search").onclick=()=>{re?(re=!1,document.getElementById("rua-danmaku-search-input").classList.remove("rua-danmaku-search-in"),document.getElementById("rua-danmaku-search-input").classList.add("rua-danmaku-search-out"),setTimeout(()=>{document.getElementById("rua-danmaku-search-input").style.display="none"},800)):(re=!0,document.getElementById("rua-danmaku-search-input").style.display="block",document.getElementById("rua-danmaku-search-input").classList.remove("rua-danmaku-search-out"),document.getElementById("rua-danmaku-search-input").classList.add("rua-danmaku-search-in"))}}();const dmObj={nested:{bilibili:{nested:{community:{nested:{service:{nested:{dm:{nested:{v1:{nested:{DM:{methods:{DmSegMobile:{requestType:"DmSegMobileReq",responseType:"DmSegMobileReply"},DmView:{requestType:"DmViewReq",responseType:"DmViewReply"},DmPlayerConfig:{requestType:"DmPlayerConfigReq",responseType:"Response"},DmSegOtt:{requestType:"DmSegOttReq",responseType:"DmSegOttReply"},DmSegSDK:{requestType:"DmSegSDKReq",responseType:"DmSegSDKReply"}}},DmSegSDKReq:{fields:{pid:{type:"int64",id:1},oid:{type:"int64",id:2},type:{type:"int32",id:3},segmentIndex:{type:"int64",id:4}}},DmSegSDKReply:{fields:{closed:{type:"bool",id:1},elems:{rule:"repeated",type:"DanmakuElem",id:2}}},DmSegOttReq:{fields:{pid:{type:"int64",id:1},oid:{type:"int64",id:2},type:{type:"int32",id:3},segmentIndex:{type:"int64",id:4}}},DmSegOttReply:{fields:{closed:{type:"bool",id:1},elems:{rule:"repeated",type:"DanmakuElem",id:2}}},DmSegMobileReq:{fields:{pid:{type:"int64",id:1},oid:{type:"int64",id:2},type:{type:"int32",id:3},segmentIndex:{type:"int64",id:4},teenagersMode:{type:"int32",id:5}}},DmSegMobileReply:{fields:{elems:{rule:"repeated",type:"DanmakuElem",id:1},state:{type:"int32",id:2},aiFlag:{type:"DanmakuAIFlag",id:3}}},DmViewReq:{fields:{pid:{type:"int64",id:1},oid:{type:"int64",id:2},type:{type:"int32",id:3},spmid:{type:"string",id:4},isHardBoot:{type:"int32",id:5}}},DmViewReply:{fields:{closed:{type:"bool",id:1},mask:{type:"VideoMask",id:2},subtitle:{type:"VideoSubtitle",id:3},specialDms:{rule:"repeated",type:"string",id:4},aiFlag:{type:"DanmakuFlagConfig",id:5},playerConfig:{type:"DanmuPlayerViewConfig",id:6},sendBoxStyle:{type:"int32",id:7},allow:{type:"bool",id:8},checkBox:{type:"string",id:9},checkBoxShowMsg:{type:"string",id:10},textPlaceholder:{type:"string",id:11},inputPlaceholder:{type:"string",id:12},reportFilterContent:{rule:"repeated",type:"string",id:13}}},DmWebViewReply:{fields:{state:{type:"int32",id:1},text:{type:"string",id:2},textSide:{type:"string",id:3},dmSge:{type:"DmSegConfig",id:4},flag:{type:"DanmakuFlagConfig",id:5},specialDms:{rule:"repeated",type:"string",id:6},checkBox:{type:"bool",id:7},count:{type:"int64",id:8},commandDms:{rule:"repeated",type:"CommandDm",id:9},playerConfig:{type:"DanmuWebPlayerConfig",id:10},reportFilterContent:{rule:"repeated",type:"string",id:11}}},CommandDm:{fields:{id:{type:"int64",id:1},oid:{type:"int64",id:2},mid:{type:"string",id:3},command:{type:"string",id:4},content:{type:"string",id:5},progress:{type:"int32",id:6},ctime:{type:"string",id:7},mtime:{type:"string",id:8},extra:{type:"string",id:9},idStr:{type:"string",id:10}}},DmSegConfig:{fields:{pageSize:{type:"int64",id:1},total:{type:"int64",id:2}}},VideoMask:{fields:{cid:{type:"int64",id:1},plat:{type:"int32",id:2},fps:{type:"int32",id:3},time:{type:"int64",id:4},maskUrl:{type:"string",id:5}}},VideoSubtitle:{fields:{lan:{type:"string",id:1},lanDoc:{type:"string",id:2},subtitles:{rule:"repeated",type:"SubtitleItem",id:3}}},DanmuWebPlayerConfig:{fields:{dmSwitch:{type:"bool",id:1},aiSwitch:{type:"bool",id:2},aiLevel:{type:"int32",id:3},blocktop:{type:"bool",id:4},blockscroll:{type:"bool",id:5},blockbottom:{type:"bool",id:6},blockcolor:{type:"bool",id:7},blockspecial:{type:"bool",id:8},preventshade:{type:"bool",id:9},dmask:{type:"bool",id:10},opacity:{type:"float",id:11},dmarea:{type:"int32",id:12},speedplus:{type:"float",id:13},fontsize:{type:"float",id:14},screensync:{type:"bool",id:15},speedsync:{type:"bool",id:16},fontfamily:{type:"string",id:17},bold:{type:"bool",id:18},fontborder:{type:"int32",id:19},drawType:{type:"string",id:20}}},SubtitleItem:{fields:{id:{type:"int64",id:1},idStr:{type:"string",id:2},lan:{type:"string",id:3},lanDoc:{type:"string",id:4},subtitleUrl:{type:"string",id:5},author:{type:"UserInfo",id:6}}},UserInfo:{fields:{mid:{type:"int64",id:1},name:{type:"string",id:2},sex:{type:"string",id:3},face:{type:"string",id:4},sign:{type:"string",id:5},rank:{type:"int32",id:6}}},DanmakuElem:{fields:{id:{type:"int64",id:1},progress:{type:"int32",id:2},mode:{type:"int32",id:3},fontsize:{type:"int32",id:4},color:{type:"uint32",id:5},midHash:{type:"string",id:6},content:{type:"string",id:7},ctime:{type:"int64",id:8},weight:{type:"int32",id:9},action:{type:"string",id:10},pool:{type:"int32",id:11},idStr:{type:"string",id:12},attr:{type:"int32",id:13}}},DMAttrBit:{values:{DMAttrBitProtect:0,DMAttrBitFromLive:1,DMAttrHighLike:2}},DmPlayerConfigReq:{fields:{ts:{type:"int64",id:1},switch:{type:"PlayerDanmakuSwitch",id:2},switchSave:{type:"PlayerDanmakuSwitchSave",id:3},useDefaultConfig:{type:"PlayerDanmakuUseDefaultConfig",id:4},aiRecommendedSwitch:{type:"PlayerDanmakuAiRecommendedSwitch",id:5},aiRecommendedLevel:{type:"PlayerDanmakuAiRecommendedLevel",id:6},blocktop:{type:"PlayerDanmakuBlocktop",id:7},blockscroll:{type:"PlayerDanmakuBlockscroll",id:8},blockbottom:{type:"PlayerDanmakuBlockbottom",id:9},blockcolorful:{type:"PlayerDanmakuBlockcolorful",id:10},blockrepeat:{type:"PlayerDanmakuBlockrepeat",id:11},blockspecial:{type:"PlayerDanmakuBlockspecial",id:12},opacity:{type:"PlayerDanmakuOpacity",id:13},scalingfactor:{type:"PlayerDanmakuScalingfactor",id:14},domain:{type:"PlayerDanmakuDomain",id:15},speed:{type:"PlayerDanmakuSpeed",id:16},enableblocklist:{type:"PlayerDanmakuEnableblocklist",id:17},inlinePlayerDanmakuSwitch:{type:"InlinePlayerDanmakuSwitch",id:18}}},Response:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2}}},DanmakuFlag:{fields:{dmid:{type:"int64",id:1},flag:{type:"uint32",id:2}}},DanmakuFlagConfig:{fields:{recFlag:{type:"int32",id:1},recText:{type:"string",id:2},recSwitch:{type:"int32",id:3}}},DanmakuAIFlag:{fields:{dmFlags:{rule:"repeated",type:"DanmakuFlag",id:1}}},DanmuPlayerViewConfig:{fields:{danmukuDefaultPlayerConfig:{type:"DanmuDefaultPlayerConfig",id:1},danmukuPlayerConfig:{type:"DanmuPlayerConfig",id:2},danmukuPlayerDynamicConfig:{rule:"repeated",type:"DanmuPlayerDynamicConfig",id:3}}},DanmuDefaultPlayerConfig:{fields:{playerDanmakuUseDefaultConfig:{type:"bool",id:1},playerDanmakuAiRecommendedSwitch:{type:"bool",id:4},playerDanmakuAiRecommendedLevel:{type:"int32",id:5},playerDanmakuBlocktop:{type:"bool",id:6},playerDanmakuBlockscroll:{type:"bool",id:7},playerDanmakuBlockbottom:{type:"bool",id:8},playerDanmakuBlockcolorful:{type:"bool",id:9},playerDanmakuBlockrepeat:{type:"bool",id:10},playerDanmakuBlockspecial:{type:"bool",id:11},playerDanmakuOpacity:{type:"float",id:12},playerDanmakuScalingfactor:{type:"float",id:13},playerDanmakuDomain:{type:"float",id:14},playerDanmakuSpeed:{type:"int32",id:15},inlinePlayerDanmakuSwitch:{type:"bool",id:16}}},DanmuPlayerConfig:{fields:{playerDanmakuSwitch:{type:"bool",id:1},playerDanmakuSwitchSave:{type:"bool",id:2},playerDanmakuUseDefaultConfig:{type:"bool",id:3},playerDanmakuAiRecommendedSwitch:{type:"bool",id:4},playerDanmakuAiRecommendedLevel:{type:"int32",id:5},playerDanmakuBlocktop:{type:"bool",id:6},playerDanmakuBlockscroll:{type:"bool",id:7},playerDanmakuBlockbottom:{type:"bool",id:8},playerDanmakuBlockcolorful:{type:"bool",id:9},playerDanmakuBlockrepeat:{type:"bool",id:10},playerDanmakuBlockspecial:{type:"bool",id:11},playerDanmakuOpacity:{type:"float",id:12},playerDanmakuScalingfactor:{type:"float",id:13},playerDanmakuDomain:{type:"float",id:14},playerDanmakuSpeed:{type:"int32",id:15},playerDanmakuEnableblocklist:{type:"bool",id:16},inlinePlayerDanmakuSwitch:{type:"bool",id:17},inlinePlayerDanmakuConfig:{type:"int32",id:18}}},DanmuPlayerDynamicConfig:{fields:{progress:{type:"int32",id:1},playerDanmakuDomain:{type:"float",id:2}}},PlayerDanmakuSwitch:{fields:{value:{type:"bool",id:1},canIgnore:{type:"bool",id:2}}},PlayerDanmakuSwitchSave:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuUseDefaultConfig:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuAiRecommendedSwitch:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuAiRecommendedLevel:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuBlocktop:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuBlockscroll:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuBlockbottom:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuBlockcolorful:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuBlockrepeat:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuBlockspecial:{fields:{value:{type:"bool",id:1}}},PlayerDanmakuOpacity:{fields:{value:{type:"float",id:1}}},PlayerDanmakuScalingfactor:{fields:{value:{type:"float",id:1}}},PlayerDanmakuDomain:{fields:{value:{type:"float",id:1}}},PlayerDanmakuSpeed:{fields:{value:{type:"int32",id:1}}},PlayerDanmakuEnableblocklist:{fields:{value:{type:"bool",id:1}}},InlinePlayerDanmakuSwitch:{fields:{value:{type:"bool",id:1}}}}}}}}}}}}}}};