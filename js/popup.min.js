!function(){function a(a){a.preventDefault()}function b(){chrome.runtime.sendMessage({msg:"get_UUID"},function(a){P=a.res;let b="";-1===P?(b="\u672A\u767B\u5F55",v.style.color="#f44336"):-2!==P&&(b="\u5DF2\u767B\u5F55",v.style.color="#6dc781"),b+="<span class=\"tooltiptext tooltiptext-middle\">b\u7AD9\u767B\u5F55\u72B6\u6001\u3002\u63D2\u4EF6\u8981\u5728b\u7AD9\u767B\u5F55\u540E\u624D\u80FD\u542F\u7528\u5168\u90E8\u529F\u80FD\u3002</span>",v.innerHTML=b})}function c(){J.checked||I.checked||H.checked||(t.checked=!1,d(!1,H),d(!1,I),d(!1,J),chrome.storage.sync.set({dynamicPush:!1},function(){}))}function d(a,b){a?(b.removeAttribute("disabled"),b.parentElement.getElementsByTagName("label")[0].classList.remove("btn-disabled")):(b.setAttribute("disabled","true"),b.parentElement.getElementsByTagName("label")[0].classList.add("btn-disabled"))}function e(a,b){a?b.classList.remove("btn-disabled"):b.classList.add("btn-disabled")}function f(a){function b(){d?c-=1:c+=1;for(let a=0;5>a;a++)document.getElementsByClassName("qn-i")[a].style.transform="rotateX("+2.5*(18*a+c)+"deg)";document.getElementById("qn-items").style.marginTop=c+"px",c!==a&&setTimeout(()=>{b()},10)}a*=-18;let c=parseInt(document.getElementById("qn-items").style.marginTop.replace("px","")),d=c>a;0!=c-a&&b()}function g(){chrome.runtime.sendMessage({msg:"popupfired"}),chrome.runtime.sendMessage({msg:"updateStatus"},function(a){a.res?(k.style.display="block",k.innerText="\u6709\u53EF\u7528\u66F4\u65B0",Q=a.address):(k.style.display="none",k.innerText="")})}function h(a,b){for(let c of a)"OPTION"===c.nodeName&&(c.getAttribute("value")!==b+""&&"selected"===c.getAttribute("selected")&&c.removeAttribute("selected"),c.getAttribute("value")===b+""&&c.setAttribute("selected","selected"))}const i=chrome.runtime.getManifest().version,j=document.getElementById("version"),k=document.getElementById("update"),l=document.getElementsByClassName("setting")[0],m=document.getElementById("notification"),n=document.getElementById("medal"),o=document.getElementById("check-in"),p=document.getElementById("img-notice"),q=document.getElementById("b-coin"),r=document.getElementById("qn"),s=document.getElementById("btn7"),t=document.getElementById("dynamicPush"),u=document.getElementById("HiddenEntry"),v=document.getElementById("login"),w=document.getElementById("daka-switch"),x=document.getElementById("record"),y=document.getElementById("prerecord"),z=document.getElementById("enhanced-hidden"),A=document.getElementById("unreadSwitch"),B=document.getElementById("dynamicSwitch"),C=document.getElementById("logo"),D=document.getElementById("darkMode"),E=document.getElementById("darkModeSystem"),F=document.getElementById("commentEmoji"),G=document.getElementById("reload"),H=document.getElementById("videoPush"),I=document.getElementById("pgcPush"),J=document.getElementById("articlePush"),K=document.getElementById("hb"),L=["\u539F\u753B","\u84DD\u5149","\u8D85\u6E05","\u9AD8\u6E05","\u6D41\u7545"],M=s.getElementsByClassName("qn-i");var N,O=0,P=-2,Q="https://gitee.com/tyrael-lee/HarukaEmoji/releases",R="";(function(){j.innerHTML="ver. <i>"+i+"</i>"})(),setInterval(b,1e3),document.getElementById("bug-reporter").addEventListener("click",function(){chrome.tabs.create({url:"https://github.com/TyraelDLee/HarukaEmoji/issues"})}),document.getElementById("logo").addEventListener("click",function(){chrome.tabs.create({url:"https://chrome.google.com/webstore/detail/rua%E8%B1%B9%E5%99%A8/igapngheaefbfhikpbngjgakfnedkchb"})}),document.getElementById("version").addEventListener("click",function(){chrome.tabs.create({url:"https://github.com/TyraelDLee/HarukaEmoji"})}),document.getElementById("source").addEventListener("click",function(){chrome.tabs.create({url:"https://github.com/TyraelDLee/HarukaEmoji"})}),document.getElementById("readme").addEventListener("click",function(){chrome.tabs.create({url:"./readme.html"})}),document.getElementsByClassName("record-manual")[0].addEventListener("click",()=>{chrome.tabs.create({url:"./readme.html#record"})}),document.getElementsByClassName("record-manual")[1].addEventListener("click",()=>{chrome.tabs.create({url:"./readme.html#record"})}),k.addEventListener("click",()=>{chrome.tabs.create({url:Q})}),m.addEventListener("change",function(){let a=this.checked;"win"==R&&d(this.checked,p),chrome.storage.sync.set({notification:a},function(){console.log("notification on:"+a)})}),n.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({medal:a},function(){})}),o.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({checkIn:a},function(){})}),p.addEventListener("change",function(){let a=this.checked;chrome.storage.local.set({imageNotice:a},function(){})}),q.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({bcoin:a},function(){})}),r.addEventListener("change",function(){N=this.checked,e(this.checked,s),chrome.storage.sync.set({qn:N},function(){})}),s.addEventListener("wheel",function(a){N&&(0<=a.deltaY?O+=1:O-=1,0>=O&&(O=0),4<=O&&(O=4),f(O),chrome.runtime.sendMessage({msg:"QNV?"+L[O]},function(){}))}),s.addEventListener("mouseenter",function(){l.addEventListener("wheel",a)}),s.addEventListener("mouseleave",function(){l.removeEventListener("wheel",a)});for(let a=0;a<M.length;a++)M[a].addEventListener("click",function(){N&&(O=a,f(O),chrome.runtime.sendMessage({msg:"QNV?"+L[O]},function(){}))});t.addEventListener("change",function(){let a=this.checked;d(a,H),d(a,I),d(a,J),!a||J.checked||I.checked||H.checked||(H.checked=!0,I.checked=!0,J.checked=!0,chrome.storage.sync.set({videoPush:!0},function(){}),chrome.storage.sync.set({pgcPush:!0},function(){}),chrome.storage.sync.set({articlePush:!0},function(){})),chrome.storage.sync.set({dynamicPush:a},function(){})}),H.addEventListener("change",function(){let a=this.checked;c(),chrome.storage.sync.set({videoPush:a},function(){})}),I.addEventListener("change",function(){let a=this.checked;c(),chrome.storage.sync.set({pgcPush:a},function(){})}),J.addEventListener("change",function(){let a=this.checked;c(),chrome.storage.sync.set({articlePush:a},function(){})}),A.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({unreadSwitch:a},function(){})}),B.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({dynamicSwitch:a},function(){})}),F.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({commentEmoji:a},function(){})}),u.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({hiddenEntry:a},function(){})}),w.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({daka:a},function(){})}),K.addEventListener("change",function(){let a=this.checked;chrome.storage.sync.set({heartBeatSwitch:a},function(){})}),z.addEventListener("change",function(){let a=this.checked;a?(u.setAttribute("disabled",""),u.parentElement.getElementsByTagName("label")[0].classList.add("btn-disabled")):(u.removeAttribute("disabled"),u.parentElement.getElementsByTagName("label")[0].classList.remove("btn-disabled")),u.checked=this.checked,chrome.storage.sync.set({enhancedHiddenEntry:a,hiddenEntry:a},function(){})}),x.addEventListener("change",function(){let a=this.checked;a?y.removeAttribute("disabled"):y.setAttribute("disabled",""),chrome.storage.sync.set({record:a},function(){})}),y.addEventListener("change",function(){let a=this.value;chrome.storage.sync.set({prerecord:a},function(){})}),D.addEventListener("change",function(){let a=this.checked;a&&(E.checked=!1,chrome.storage.sync.set({darkModeSystem:!1},function(){})),chrome.storage.sync.set({darkMode:a},function(){})}),E.addEventListener("change",function(){let a=this.checked;this.checked&&(D.checked=!1,chrome.storage.sync.set({darkMode:!1},function(){})),chrome.storage.sync.set({darkModeSystem:a},function(){})}),G.addEventListener("click",function(){chrome.runtime.sendMessage({msg:"requestReload"},function(){console.log("\u670D\u52A1\u91CD\u542F\u6210\u529F")})}),window.onload=function(){g(),b(),chrome.runtime.sendMessage({msg:"requestOSInfo"},function(a){R=a.os,"win"!==a.os&&d(!1,p)}),chrome.storage.sync.get(["notification","medal","checkIn","bcoin","dynamicPush","unreadSwitch","hiddenEntry","daka","qn","qnvalue","enhancedHiddenEntry","record","prerecord","dynamicSwitch","darkMode","darkModeSystem","commentEmoji","videoPush","pgcPush","articlePush","heartBeatSwitch"],function(a){"win"===R&&d(a.notification,p),m.checked=a.notification,n.checked=a.medal,o.checked=a.checkIn,q.checked=a.bcoin,t.checked=a.dynamicPush,H.checked=a.videoPush,I.checked=a.pgcPush,J.checked=a.articlePush,A.checked=a.unreadSwitch,B.checked=a.dynamicSwitch,u.checked=a.hiddenEntry,w.checked=a.daka,K.checked=a.heartBeatSwitch,F.checked=a.commentEmoji,r.checked=a.qn,N=a.qn,e(a.qn,s),O=L.indexOf(a.qnvalue),f(O),D.checked=a.darkMode,E.checked=a.darkModeSystem,a.enhancedHiddenEntry?(u.setAttribute("disabled",""),u.checked=a.enhancedHiddenEntry,u.parentElement.getElementsByTagName("label")[0].classList.add("btn-disabled")):(u.removeAttribute("disable"),u.parentElement.getElementsByTagName("label")[0].classList.remove("btn-disabled")),z.checked=a.enhancedHiddenEntry,x.checked=a.record,a.record||y.setAttribute("disabled",""),h(y.childNodes,a.prerecord)}),chrome.storage.local.get(["imageNotice"],(a)=>{p.checked=a.imageNotice})},C.addEventListener("mouseenter",()=>{svga(C,Math.floor(2*Math.random()+1))}),C.addEventListener("mouseout",()=>{svga(C,0)})}();