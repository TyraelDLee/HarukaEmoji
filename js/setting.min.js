!function(){function a(a){let b=[a.offsetLeft,a.offsetTop],c=a.offsetParent;for(;null!==c;)b[0]+=c.offsetLeft,b[1]+=c.offsetTop+c.clientTop,c=c.offsetParent;return b}function b(a,e,f,g=!1,h=!1,i=""){return fetch(h?`https://api.bilibili.com/x/relation/followings/search?vmid=${e}&pn=${a}&ps=${l}&order=desc&order_type=attention&name=${i}`:`https://api.bilibili.com/x/relation/${g?`whispers?`:`followings?vmid=${e}&`}pn=${a}&ps=${l}`,{method:"GET",credentials:"include",body:null}).then(a=>a.json()).then(h=>{if(0===h.code){for(let a=0;a<h.data.list.length;a++)u.push(h.data.list[a].mid),d(h.data.list[a].face,h.data.list[a].uname,h.data.list[a].mid,h.data.list[a].official_verify.type,h.data.list[a].official_verify.desc,k.get(h.data.list[a].mid));return a===f&&(g?(document.getElementById("loading").style.display="none",c()):b(1,e,1,!0).then(a=>{a<=l&&(document.getElementById("loading").style.display="none")})),t=!0,"undefined"==typeof h.data.total?h.data.list.length+1:h.data.total}return 0})}function c(){fetch(`https://api.live.bilibili.com/xlive/web-ucenter/user/MedalWall?target_id=${j}`,{method:"GET",credentials:"include",body:null}).then(a=>a.json()).then(a=>{if(0===a.code)for(const b of a.data.list)-1===u.indexOf(b.medal_info.target_id)&&d(b.target_icon,b.target_name,b.medal_info.target_id,b.official-1,"",[b.medal_info.level,b.medal_info.medal_color_border,b.medal_info.medal_color_start,b.medal_info.medal_color_end,b.medal_info.medal_name],!0)}).catch(a=>{})}function d(a,b,c,d,f,g=[0,0,0,0,0],h=!1){c-=0;let j=0===d?"background-position: var(--personal-verify);":1===d?"background-position: var(--organization-verify);":"display: none;",k=document.createElement("div");k.classList.add("rua-setting-user-block"),k.innerHTML=`<div class="rua-setting-user-info">
            <a href="https://space.bilibili.com/${c}" target="_blank" class="user-face"><img src="${a}"><span class="verified" style="${j}"></span></a>
            <div class="user-name"><div style="display: flex"><a href="https://space.bilibili.com/${c}" target="_blank">${b}</a><span class="medal" ${-1===g.indexOf(0)?"":`style="display:none;"`}><div class="medal-border" style="border-color: rgb(${e(g[1])})"><div class="medal-label" style="background-image: linear-gradient(45deg, rgb(${e(g[2])}), rgb(${e(g[3])}));"><span class="medal-name">${g[4]}</span></div><div class="medal-level" style="color: rgb(${e(g[1])})">${g[0]}</div></div></span></div><span class="verify-text">${f}</span></div>
        </div>
        <div class="rua-setting-button-group">
            <div class="button-host">
                <section class="button">
                    <div class="checkbox">
                        <input id="rua-input-hb-${c}" type="checkbox" ${-1===q.indexOf(c)&&-1===g.indexOf(0)?"checked":""} ${-1===g.indexOf(0)?"":"disabled"}>
                        <label ${-1===g.indexOf(0)?"":`class="btn-disabled"`}></label>
                    </div>
                </section>
            </div>
            <div class="button-host">
                <section class="button">
                    <div class="checkbox">
                        <input id="rua-input-dk-${c}" type="checkbox" ${-1===p.indexOf(c)&&-1===g.indexOf(0)?"checked":""} ${-1===g.indexOf(0)?"":"disabled"}>
                        <label ${-1===g.indexOf(0)?"":`class="btn-disabled"`}></label>
                    </div>
                </section>
            </div>
            <div class="button-host">
                <section class="button">
                    <div class="checkbox">
                        <input id="rua-input-live-${c}" type="checkbox" ${-1!==m.indexOf(c)||h?"":"checked"} ${h?"disabled":""}>
                        <label ${h?`class="btn-disabled"`:""}></label>
                    </div>
                </section>
            </div>
            <div class="button-host">
                <section class="button">
                    <div class="checkbox">
                        <input id="rua-input-video-${c}" type="checkbox" ${-1!==n.indexOf(c)||h?"":"checked"} ${h?"disabled":""}>
                        <label ${h?`class="btn-disabled"`:""}></label>
                    </div>
                </section>
            </div>
            <div class="button-host">
                <section class="button">
                    <div class="checkbox">
                        <input id="rua-input-dynamic-${c}" type="checkbox" ${-1!==o.indexOf(c)||h?"":"checked"} ${h?"disabled":""}>
                        <label ${h?`class="btn-disabled"`:""}></label>
                    </div>
                </section>
            </div>
        </div>`,i.appendChild(k),document.getElementById(`rua-input-hb-${c}`).addEventListener("change",function(a){let b=a.target.checked,d=[];chrome.storage.sync.get(["blackListHB"],a=>{d=a.blackListHB,b?d.splice(d.indexOf(c),1):d.push(c),chrome.storage.sync.set({blackListHB:d},()=>{})})}),document.getElementById(`rua-input-dk-${c}`).addEventListener("change",function(a){let b=a.target.checked,d=[];chrome.storage.sync.get(["blackListDK"],a=>{d=a.blackListDK,b?d.splice(d.indexOf(c),1):d.push(c),chrome.storage.sync.set({blackListDK:d},()=>{})})}),document.getElementById(`rua-input-live-${c}`).addEventListener("change",function(a){let b=a.target.checked,d=[];chrome.storage.sync.get(["blackListLive"],a=>{d=a.blackListLive,b?d.splice(d.indexOf(c),1):d.push(c),chrome.storage.sync.set({blackListLive:d},()=>{})})}),document.getElementById(`rua-input-video-${c}`).addEventListener("change",function(){let a=this.checked,b=[];chrome.storage.sync.get(["blackListVideo"],d=>{b=d.blackListVideo,a?b.splice(b.indexOf(c),1):b.push(c),chrome.storage.sync.set({blackListVideo:b},()=>{})})}),document.getElementById(`rua-input-dynamic-${c}`).addEventListener("change",function(){let a=this.checked,b=[];chrome.storage.sync.get(["blackListDynamic"],d=>{b=d.blackListDynamic,a?b.splice(b.indexOf(c),1):b.push(c),chrome.storage.sync.set({blackListDynamic:b},()=>{})})})}function e(a){return parseInt(a.toString(16).substring(0,2),16)+" "+parseInt(a.toString(16).substring(2,4),16)+" "+parseInt(a.toString(16).substring(4,6),16)}function f(){return new Promise((a,b)=>{chrome.runtime.sendMessage({msg:"get_UUID"},function(b){a(b.res)})})}function g(a){return fetch(`https://api.bilibili.com/x/relation/stat?vmid=${a}&jsonp=jsonp`,{method:"GET",credentials:"include",body:null}).then(a=>a.json()).then(a=>0===a.code?{code:0,following:a.data.following,whisper:a.data.whisper}:{code:-1})}function h(a){return fetch(`https://api.live.bilibili.com/xlive/web-ucenter/user/MedalWall?target_id=${a}`,{method:"GET",credentials:"include",body:null}).then(a=>a.json()).then(a=>{if(0===a.code){let b=new Map;for(let c=0;c<a.data.list.length;c++)b.set(a.data.list[c].medal_info.target_id,[a.data.list[c].medal_info.level,a.data.list[c].medal_info.medal_color_border,a.data.list[c].medal_info.medal_color_start,a.data.list[c].medal_info.medal_color_end,a.data.list[c].medal_info.medal_name]);return b}return new Map}).catch(a=>new Map)}const i=document.getElementById("up-setting");let j,k,l=50,m=[],n=[],o=[],p=[],q=[],s=!1,t=!0,u=[];!function(){function a(){y.checked||x.checked||w.checked||(v.checked=!1,c(!1,w),c(!1,x),c(!1,y),chrome.storage.sync.set({dynamicPush:!1},function(){}))}function b(){chrome.runtime.sendMessage({msg:"requestOSInfo"},function(a){"win"!==a.os&&c(!1,e)}),chrome.storage.sync.get(["notification","medal","checkIn","bcoin","dynamicPush","unreadSwitch","hiddenEntry","daka","qn","qnvalue","enhancedHiddenEntry","record","prerecord","dynamicSwitch","darkMode","darkModeSystem","commentEmoji","videoPush","pgcPush","articlePush","heartBeatSwitch","squareCover","dkWord","hiddenOnVideoBtn","notificationMaster","popupDisable","popupAlwaysOnTop","liveroomZan"],a=>{d.checked=a.notification,f.checked=a.hiddenEntry,g.checked=a.enhancedHiddenEntry,a.enhancedHiddenEntry?(f.setAttribute("disable",""),f.checked=a.enhancedHiddenEntry,f.parentElement.getElementsByTagName("label")[0].classList.add("btn-disabled")):(f.removeAttribute("disable"),f.parentElement.getElementsByTagName("label")[0].classList.remove("btn-disabled")),h.checked=a.qn,i.value=a.qnvalue,j.checked=a.checkIn,k.checked=a.daka,""!==a.dkWord&&(l.value=a.dkWord),m.checked=a.medal,n.checked=a.heartBeatSwitch,o.checked=a.bcoin,p.checked=a.commentEmoji,q.checked=a.squareCover,r.checked=a.darkMode,s.checked=a.darkModeSystem,A.checked=a.notificationMaster,t.checked=a.unreadSwitch,u.checked=a.dynamicSwitch,v.checked=a.dynamicPush,w.checked=a.videoPush,x.checked=a.pgcPush,y.checked=a.articlePush,c(a.dynamicPush,w),c(a.dynamicPush,x),c(a.dynamicPush,y),z.checked=a.hiddenOnVideoBtn,B.checked=a.popupDisable,C.checked=a.popupAlwaysOnTop,D.checked=a.liveroomZan}),chrome.storage.local.get(["imageNotice"],a=>{e.checked=a.imageNotice})}function c(a,b){a?(b.removeAttribute("disabled"),b.parentElement.getElementsByTagName("label")[0].classList.remove("btn-disabled")):(b.setAttribute("disabled","true"),b.parentElement.getElementsByTagName("label")[0].classList.add("btn-disabled"))}const d=document.getElementById("setting-item-switch-notification"),e=document.getElementById("setting-item-switch-img-notice"),f=document.getElementById("setting-item-switch-hidden-entry"),g=document.getElementById("setting-item-switch-enhanced-hidden-entry"),h=document.getElementById("setting-item-switch-default-quality"),i=document.getElementById("setting-item-selection-quality"),j=document.getElementById("setting-item-switch-check-in"),k=document.getElementById("setting-item-switch-dk"),l=document.getElementById("setting-item-input-dk-word"),m=document.getElementById("setting-item-switch-madel"),n=document.getElementById("setting-item-switch-heartbeat"),o=document.getElementById("setting-item-switch-b-coin"),p=document.getElementById("setting-item-switch-up-emoji"),q=document.getElementById("setting-item-switch-cover-clip"),r=document.getElementById("setting-item-switch-dark-mode"),s=document.getElementById("setting-item-switch-dark-mode-follow-system"),t=document.getElementById("setting-item-switch-message-notification"),u=document.getElementById("setting-item-switch-dynamic-notification"),v=document.getElementById("setting-item-switch-update-notification"),w=document.getElementById("setting-item-switch-video-notification"),x=document.getElementById("setting-item-switch-pcg-notification"),y=document.getElementById("setting-item-switch-article-notification"),z=document.getElementById("setting-item-switch-hidden-video-btn"),A=document.getElementById("setting-item-switch-notification-master"),B=document.getElementById("setting-item-popup-disable"),C=document.getElementById("setting-item-popup-always-on-top"),D=document.getElementById("setting-item-switch-zan");z.addEventListener("change",()=>{chrome.storage.sync.set({hiddenOnVideoBtn:z.checked},()=>{})}),d.addEventListener("change",()=>{chrome.storage.sync.set({notification:d.checked},()=>{})}),e.addEventListener("change",()=>{chrome.storage.local.set({imageNotice:e.checked},()=>{})}),f.addEventListener("change",()=>{chrome.storage.sync.set({hiddenEntry:f.checked},()=>{})}),g.addEventListener("change",()=>{const a=g.checked;c(a,f),f.checked=a,chrome.storage.sync.set({enhancedHiddenEntry:a,hiddenEntry:a},function(){})}),h.addEventListener("change",()=>{chrome.storage.sync.set({qn:h.checked},()=>{})}),i.addEventListener("change",()=>{chrome.storage.sync.set({qnvalue:i.value},()=>{})}),j.addEventListener("change",()=>{chrome.storage.sync.set({checkIn:j.checked},function(){})}),k.addEventListener("change",()=>{chrome.storage.sync.set({daka:k.checked},function(){})}),l.addEventListener("input",()=>{chrome.storage.sync.set({dkWord:l.value},function(){})}),m.addEventListener("change",()=>{chrome.storage.sync.set({medal:m.checked},function(){})}),n.addEventListener("change",()=>{chrome.storage.sync.set({heartBeatSwitch:n.checked},function(){})}),o.addEventListener("change",()=>{chrome.storage.sync.set({bcoin:o.checked},function(){})}),p.addEventListener("change",()=>{chrome.storage.sync.set({commentEmoji:p.checked},function(){})}),q.addEventListener("change",()=>{chrome.storage.sync.set({squareCover:q.checked},function(){})}),r.addEventListener("change",()=>{const a=r.checked;a&&(s.checked=!1,chrome.storage.sync.set({darkModeSystem:!1},function(){})),chrome.storage.sync.set({darkMode:a},function(){})}),s.addEventListener("change",()=>{const a=s.checked;this.checked&&(r.checked=!1,chrome.storage.sync.set({darkMode:!1},function(){})),chrome.storage.sync.set({darkModeSystem:a},function(){})}),t.addEventListener("change",()=>{chrome.storage.sync.set({unreadSwitch:t.checked},function(){})}),u.addEventListener("change",()=>{chrome.storage.sync.set({dynamicSwitch:u.checked},function(){})}),v.addEventListener("change",()=>{const a=v.checked;c(a,w),c(a,x),c(a,y),!a||y.checked||x.checked||w.checked||(w.checked=!0,x.checked=!0,y.checked=!0,chrome.storage.sync.set({videoPush:!0},function(){}),chrome.storage.sync.set({pgcPush:!0},function(){}),chrome.storage.sync.set({articlePush:!0},function(){})),chrome.storage.sync.set({dynamicPush:a},function(){})}),A.addEventListener("change",()=>{chrome.storage.sync.set({notificationMaster:A.checked},function(){})}),w.addEventListener("change",()=>{a(),chrome.storage.sync.set({videoPush:w.checked},function(){})}),x.addEventListener("change",()=>{a(),chrome.storage.sync.set({videoPush:x.checked},function(){})}),y.addEventListener("change",()=>{a(),chrome.storage.sync.set({videoPush:y.checked},function(){})}),B.addEventListener("change",()=>{chrome.storage.sync.set({popupDisable:B.checked},function(){})}),C.addEventListener("change",()=>{chrome.storage.sync.set({popupAlwaysOnTop:C.checked},function(){})}),D.addEventListener("change",()=>{chrome.storage.sync.set({liveroomZan:D.checked},function(){})}),b()}(),!async function(){var c=Math.floor,d=Math.ceil;j=await f();let e=await g(j);k=await h(j);const r=document.getElementById("rua-icon");let u=1,v=d((e.following-0)/l),w=d((e.whisper-0)/l);const x=document.getElementById("setting-search-user");let y=null,z=!1,A="",B=1,C=z?B:v;const D=i.firstElementChild,E=D.nextElementSibling;x.addEventListener("input",()=>{clearTimeout(y),y=setTimeout(async()=>{z=""!==x.value,A=x.value,i.innerHTML="",i.appendChild(D),i.appendChild(E),u=1,""===x.value?(await b(1,j,v,!1),C=v):(B=await b(1,j,1,s,z,A),B=d(B/l),C=B)},300)}),r.addEventListener("click",()=>{document.documentElement.scrollTop=0}),r.addEventListener("mouseenter",()=>{svga(r.getElementsByTagName("img")[0],c(2*Math.random()+1))}),r.addEventListener("mouseout",()=>{svga(r.getElementsByTagName("img")[0],0)}),r.addEventListener("touchstart",()=>{svga(r.getElementsByTagName("img")[0],c(2*Math.random()+1))}),r.addEventListener("touchend",()=>{svga(r.getElementsByTagName("img")[0],0)}),chrome.storage.sync.get(["blackListLive","blackListDynamic","blackListVideo","blackListDK","blackListHB","uuid"],a=>{m=a.blackListLive,o=a.blackListDynamic,n=a.blackListVideo,p=a.blackListDK,q=a.blackListHB,b(1,j,v,s)});let F=document.documentElement.scrollTop,G=a(document.getElementById("rua-head"));document.body.onscroll=a=>{document.documentElement.scrollTop>G[1]-90?(document.getElementById("rua-head").setAttribute("style",`top: 90px; position: fixed; padding: 20px 75px;border-bottom:none;`),document.getElementById("rua-head").classList.add("rua-head-border"),document.getElementById("rua-head-space").setAttribute("style",`display:block; padding: 0; border: none;`)):(document.getElementById("rua-head").removeAttribute("style"),document.getElementById("rua-head").classList.remove("rua-head-border"),document.getElementById("rua-head-space").setAttribute("style",`display:none; padding: 0; border: none;`)),-70>=d(document.body.clientHeight-document.documentElement.scrollTop-window.innerHeight)&&(F=document.documentElement.scrollTop-F,t&&0<F&&(t=!1,u++,u<=C&&b(u,j,C,s,z,A),u===v+1&&!s&&!z&&(u=1,C=w,s=!0)),F=document.documentElement.scrollTop)}}()}();