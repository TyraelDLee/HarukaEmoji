!function(){function a(){document.getElementById("chat-items")===void 0?setTimeout(a,100):0===document.getElementById("chat-items").getElementsByClassName("important-prompt-item").length?setTimeout(a,10):document.getElementById("chat-items").getElementsByClassName("important-prompt-item")[0].style.display="none"}function b(){$.ajax({url:"http://api.live.bilibili.com/room/v1/Room/room_init?id="+q,type:"GET",dataType:"json",json:"callback",xhrFields:{withCredentials:!0},success:function(a){0===a.code&&(p=a.data.uid,d(a.data.uid))}})}function d(a){$.ajax({url:"https://api.live.bilibili.com/xlive/web-ucenter/user/MedalWall?target_id="+o,type:"GET",dataType:"json",json:"callback",xhrFields:{withCredentials:!0},success:function(b){if(0===b.code){let c=b.data.list;for(let a=0;a<c.length;a++)n.push(new Medal(c[a].medal_info.medal_id,c[a].medal_info.target_id,c[a].medal_info.target_id,c[a].medal_info.medal_name,c[a].medal_info.level,c[a].medal_info.medal_color_start,c[a].medal_info.medal_color_end,c[a].medal_info.medal_color_border));e(n.getByUid(a),!0)}}})}function e(a,b){if("-1"!==m&&j&&"-1"!==a.MID){var c=new FormData;c.append("medal_id",a.MID),c.append("csrf",m),c.append("csrf_token",m),$.ajax({url:"https://api.live.bilibili.com/xlive/web-room/v1/fansMedal/wear",type:"POST",data:c,dataType:"JSON",processData:!1,contentType:!1,cache:!1,xhrFields:{withCredentials:!0},success:function(){console.log("ware medal successful, MID="+a.MID),b&&f(a)}})}}function f(a){let b=document.createEvent("MouseEvents");if(b.initEvent("click",!1,!0),0===document.getElementsByClassName("medal-section").length||0===document.getElementsByClassName("medal-section")[0].getElementsByTagName("span").length||0===document.getElementsByClassName("medal-section")[0].getElementsByTagName("span")[0].getElementsByTagName("span").length)setTimeout(()=>{f(a)},200);else{let c=document.getElementsByClassName("medal-section")[0].getElementsByTagName("span")[0];c.dispatchEvent(b),setTimeout(function(){let b=document.getElementById("control-panel-ctnr-box").getElementsByClassName("medal")[0];void 0!==b&&(b.style.display="none");let c=document.getElementById("control-panel-ctnr-box").getElementsByClassName("fans-medal-content")[0].innerText;console.log(a),(void 0===c||c!==a.mName)&&setTimeout(()=>{f(a)},1e3)},20)}}function c(a){let b=document.createEvent("MouseEvents");if(b.initEvent("mousemove",!1,!1),void 0===document.getElementById("live-player")||void 0===document.getElementById("live-player").getElementsByClassName("web-player-controller-wrap").length||0===document.getElementById("live-player").getElementsByClassName("web-player-controller-wrap").length)setTimeout(c,200);else{let c=document.getElementById("live-player"),d=c.getElementsByClassName("web-player-controller-wrap");void 0!==d&&(d[0].style.visibility="hidden",d[1].style.visibility="hidden"),c.dispatchEvent(b),setTimeout(function(){b.initEvent("mouseenter",!1,!0);let e=c.getElementsByClassName("quality-wrap")[0];void 0!==e&&(e.dispatchEvent(b),b.initEvent("click",!1,!0),setTimeout(function(){let d=e.getElementsByClassName("panel")[0].getElementsByClassName("quality-it");if(1<d.length){let e=[];for(let a=0;a<d.length;a++)e.push(d[a].innerHTML.replaceAll(" ",""));d[g(a,e)].dispatchEvent(b),b.initEvent("mouseleave",!1,!1),c.dispatchEvent(b)}},100)),setTimeout(()=>{void 0!==d&&(d[0].style.visibility="visible",d[1].style.visibility="visible")},250)},100)}}function g(a,b){let c=0;for(let d=0;d<b.length;d++)h[b[d]]>=h[a]&&(c=d);return c}const h={原画:1e4,蓝光HEVC:401,蓝光:400,超清HEVC:251,超清:250,高清:150,流畅:80};var i,j,k="\u539F\u753B",l=!1,m="-1",n=new MedalList,o="",p="",q=window.location.pathname.replaceAll("/","").replace("blanc",""),r=/^[0-9]*$/;chrome.storage.sync.get(["qn"],function(a){i=a.qn}),chrome.storage.sync.get(["qnvalue"],function(a){k=a.qnvalue}),chrome.storage.sync.get(["medal"],a=>{j=a.medal}),chrome.storage.sync.get(["hiddenEntry"],a=>{l=a.hiddenEntry}),chrome.storage.onChanged.addListener(function(a){for(let[b,{oldValue:c,newValue:d}]of Object.entries(a))"medal"===b&&(j=d)}),function(){chrome.runtime.sendMessage({msg:"get_LoginInfo"},function(a){m=a.res.split(",")[0]}),chrome.runtime.sendMessage({msg:"get_UUID"},a=>{o=a.res})}(),setTimeout(function(){r.test(q)&&0<q.length&&b(),i&&r.test(q)&&0<q.length&&0===document.getElementsByTagName("article").length&&c(k),l&&"-1"!==m&&r.test(q)&&0<q.length&&0===document.getElementsByTagName("article").length&&a()},10),function(){function a(){if(document.getElementsByClassName("live-haruna-ctnr")[0]===void 0)setTimeout(a,200);else{let a=document.getElementsByClassName("live-haruna-ctnr")[0].getAttribute("style").replace(";","");document.getElementsByClassName("live-haruna-ctnr")[0].setAttribute("style",a+" scale("+b+");");var c=new MutationObserver(function(a){a.forEach(function(a){if("attributes"===a.type&&"style"===a.attributeName){let a=document.getElementsByClassName("live-haruna-ctnr")[0].getAttribute("style").replace(";","");a.includes("scale")||document.getElementsByClassName("live-haruna-ctnr")[0].setAttribute("style",a+" scale("+b+");")}})});c.observe(document.getElementsByClassName("live-haruna-ctnr")[0],{attributes:!0})}}let b=1/window.devicePixelRatio;a()}(),window.addEventListener("focus",function(){e(n.getByUid(p),!1)})}();