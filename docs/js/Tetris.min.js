(function(){function a(a){const b=document.getElementsByTagName('main')[0];for(let c=0;c<a.length;c++)for(let d=0;d<a[0].length;d++)if(1===a[c][d]){let a=c,e=3+d;const f=document.createElement('img');f.src='images/svga/13.svg',f.classList.add('block-img'),f.setAttribute('frame','13'),f.setAttribute('moving','1'),f.setAttribute('location',`${a},${e}`),f.setAttribute('style',`height: ${k()}px; width: ${k()}px; top: ${a*k()}px; left: ${e*k()}px`),b.appendChild(f),m[a][e]=1}}function b(a){let b,c=document.getElementsByTagName('main')[0].querySelectorAll('img'),d=!1;return c.forEach((b)=>{if('1'===b.getAttribute('moving')){let c=b.getAttribute('location').split(',')[1]-0,e=b.getAttribute('location').split(',')[0]-0;e<h&&2===m[e+a][c]&&(d=!0)}}),c.forEach((c)=>{if('1'===c.getAttribute('moving')){let e=c.getAttribute('location').split(',')[1]-0,f=c.getAttribute('location').split(',')[0]-0;f<h-1&&!d?(c.setAttribute('location',`${f+a},${e}`),c.style.top=`${(f+a)*k()}px`,m[f][e]=0,m[f+a][e]=1,b=!1):(m[f][e]=2,c.setAttribute('moving','0'),b=!0)}}),b}function c(a){let b,c,e=document.getElementsByTagName('main')[0].querySelectorAll('img'),f=l+1,g=-1;e.forEach((a)=>{'1'===a.getAttribute('moving')&&(a.getAttribute('location').split(',')[1]-0>g&&(g=a.getAttribute('location').split(',')[1]-0,c=a.getAttribute('location').split(',')[0]-0),a.getAttribute('location').split(',')[1]-0<f&&(f=a.getAttribute('location').split(',')[1]-0,b=a.getAttribute('location').split(',')[0]-0))}),d(a)&&(a=0),e.forEach((b)=>{if('1'===b.getAttribute('moving')){let c=b.getAttribute('location').split(',')[1],d=b.getAttribute('location').split(',')[0];b.setAttribute('location',`${d},${c-0+a}`),b.style.left=`${(c-0+a)*k()}px`,m[d-0][c-0]=0,m[d-0][c-0+a]=1}})}function d(a){for(let b=0;b<m.length-1;b++){if(1===m[b][0]&&-1===a)return!0;if(1===m[b][m[b].length-1]&&1===a)return!0;for(let c=0;c<m[b].length;c++)if(1===m[b][c]&&2===m[b][c+a])return!0}return!1}function f(){let a=document.getElementsByTagName('main')[0].querySelectorAll('img'),b=[h+1,-1,l+1,-1],c=[];a.forEach((a)=>{if('1'===a.getAttribute('moving')){let d=a.getAttribute('location').split(',')[0]-0,e=a.getAttribute('location').split(',')[1]-0;c.push([d,e]),b[0]>d&&(b[0]=d),b[1]<d&&(b[1]=d),b[2]>e&&(b[2]=e),b[3]<e&&(b[3]=e)}});let d=[b[0]+j((b[1]-b[0])/2),b[2]+j((b[3]-b[2])/2)],f=[[0,0],[0,0],[0,0],[0,0]],g=0;for(let a=0;a<c.length;a++)f[a][0]=d[0]+d[1]-c[a][1],f[a][1]=d[1]-d[0]+c[a][0];e(f)||(m[c[0][0]][c[0][1]]=0,m[c[1][0]][c[1][1]]=0,m[c[2][0]][c[2][1]]=0,m[c[3][0]][c[3][1]]=0,m[f[0][0]][f[0][1]]=1,m[f[1][0]][f[1][1]]=1,m[f[2][0]][f[2][1]]=1,m[f[3][0]][f[3][1]]=1,a.forEach((a)=>{'1'===a.getAttribute('moving')&&(a.setAttribute('location',`${f[g][0]},${f[g][1]}`),a.style.top=`${f[g][0]*k()}px`,a.style.left=`${f[g][1]*k()}px`,g++)}))}function e(a){for(let b=0;b<a.length;b++){if(0>a[b][0]||a[b][0]>h-1||0>a[b][1]||a[b][1]>l-1)return!0;if(2===m[a[b][0]][a[b][1]])return!0}return!1}function g(){return-1!==m[0].indexOf(2)}function i(){let c=!1,d=0,e=-1,f=!0;for(let a=0;a<m.length-1;a++)if(-1===m[a].indexOf(1)&&-1===m[a].indexOf(0)){f&&(e=a),f=!1,d=a,c=!0,m[a]=Array(l).fill(0);let b=document.getElementsByTagName('main')[0].querySelectorAll('img');b.forEach((a)=>{a.getAttribute('location').split(',')[0]-0===d&&'0'===a.getAttribute('moving')&&document.getElementsByTagName('main')[0].removeChild(a)})}if(c){for(let a=0;a<d;a++)for(let b=0;b<m[a].length;b++)if(2===m[a][b]){m[a][b]=1;let c=document.getElementsByTagName('main')[0].querySelectorAll('img');c.forEach((c)=>{'0'===c.getAttribute('moving')&&`${a},${b}`===c.getAttribute('location')&&c.setAttribute('moving','1')})}b(d-e+1)}else a(n[j(Math.random()*(n.length-1))])}function k(){return window.innerWidth/l<window.innerHeight/h?window.innerWidth/l:window.innerHeight/h}var j=Math.floor;let l,h,m=[];const n=[[[1,1,1,1]],[[1,1],[1,1]],[[1,1,1],[0,1,0]],[[0,1,1],[1,1,0]],[[1,1,0],[0,1,1]],[[0,0,1],[1,1,1]],[[1,0,0],[1,1,1]]];(function(a,b){h=a,l=b;const c=document.getElementsByTagName('main')[0];c.style.height=a*k()+'px',c.style.width=b*k()+'px',m=Array(a).fill(0).map(()=>Array(b).fill(0)),m.push(Array(b).fill(2))})(20,10),a(n[j(Math.random()*(n.length-1))]),window.addEventListener('resize',()=>{let a=document.getElementsByTagName('main')[0].querySelectorAll('.block-img');a.forEach((a)=>{a.style.height=k()+'px',a.style.width=k()+'px'})}),window.addEventListener('keydown',(a)=>{switch(a.code){case'ArrowUp':f();break;case'ArrowLeft':c(-1);break;case'ArrowRight':c(1);break;case'ArrowDown':b(1)&&!g()&&i();break;case'KeyW':f();break;case'KeyA':c(-1);break;case'KeyD':c(1);break;case'KeyS':b(1)&&!g()&&i();}}),setInterval(()=>{b(1)&&!g()&&i()},1e3)})();